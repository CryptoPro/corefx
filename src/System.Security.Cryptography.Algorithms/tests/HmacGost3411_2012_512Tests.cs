//Licensedtothe.NETFoundationunderoneormoreagreements.
//The.NETFoundationlicensesthisfiletoyouundertheMITlicense.
//SeetheLICENSEfileintheprojectrootformoreinformation.

using Test.Cryptography;
using Xunit;

namespace System.Security.Cryptography.Hashing.Algorithms.Tests
{
    public class HmacGost3411_2012_512Tests: HmacTests
    {
        private static readonly byte[][]s_testKeys=
        {
            null,
            ByteUtils.HexToByteArray("55E7C6FF27633F24753CA7924FC91B46E3F6860E5F4CB7770E1157AFB4C41C528AF6F78D721DAFD675D6D4A30706A77771DF6E3BF984321EEF8D94E60D49D979"),
            ByteUtils.HexToByteArray("03670D3918C3973AEE3D143B8F4A0E9AAFE5B41F960EBEBBD97CA72336C9F22F09A622555C6803998A2B86F7E28062739BB61A8ED30AC700EACBA2854BF0535E"),
            ByteUtils.HexToByteArray("77D886DF4AD4F75B61D7D36F5709A9E106A1AC218FA0C4023E29372C371EA087141239CA6DAC5448725B9D0D2A8413C6C7AE4703BC08CFBC2B0C0CBBFCB25686"),
            ByteUtils.HexToByteArray("0AB6E8239CC62D6BCC6AA3AE57249CFC901503350F9456FA0A79F5DB42AD145D609EA88AF729D5EC6502E80861192D7E995A7C67FFC7F3E529C01FF1FD88FD33"),
            ByteUtils.HexToByteArray("1E4E8DA205CDC138648656205E3179FB5E99B7EB32F14BE0C0243F121FC0119DDC7A5CEADF59672850C31EC55C110B8601EE1F56102E135425E89F010C6A04F3"),
            ByteUtils.HexToByteArray("95CA1CC05CBEF29B6C074295FA68548CE6C6BD781B75B945265DF7C7ADCB7458A8117C14A4F32C685CA98701E09717A73264BCA669F76F39645E447EF04AEA51"),
            ByteUtils.HexToByteArray("B3BB359D9E7DF5CFF0978F3F0BB89068C06907441735B198C0422133B55CD069D5FEBB5DEA4B0DD4E0E84942111A66679A610CC079A9C83D46CD0C39924F2A81"),
        };

        private static readonly byte[][]s_testData=
        {
            null,
            ByteUtils.RepeatByte(0x00, 0),
            ByteUtils.HexToByteArray("B8B56F3070AFF95D1E6FBBAAF6F9C5F86C308056B258F3AFAC4231EA98F2BC954491CCF4D4A9EE4FED8865BC44DE0301E228755CDB4D8A612E"),
            ByteUtils.HexToByteArray("718A54CD656F7B450E2C30EBDDFADC4362153F4FBFD0D64E14ABE7F1A38BF1C357F9B4498F3E1262D4F1C617FEEEE8D307B0127D233A93C48D7CC7879F33DDCF"),
            ByteUtils.HexToByteArray("D5387628270934CE5E56C64EC110A9F1CD457D656A44EA3A785BAFF42946F51FBD513C49BCD9D2281F9306FB154B9BA9CAC596F6506D1B34B6DF6801229A2A0622964F03232238DF23B919DD9509FCE80291120049DB45"),
            ByteUtils.HexToByteArray("B3BD18D91CC51E388E10656B667AC5C47A796F932E69C94C60AD91489023B68606C50D4B833F0C0A61A9C570FCC364D2581AF0C80067747400651D8174B91F71833F1315083D387A08E8454FFD7E1B200157C5008EA8495F96EDD5FABA9EDF746EDBA0A53B02FBC65879394E2555F687B734C115460757059D8DCFEF46F487D1F256EA511045FFF6A6B24612E96289D552B8EA4BF09B75FC841F4D5179AC06F50805712D59D127684BC3A465DBD42A0F54DEBC407DED803596866330AC3D4A986E6D8E211EA0227FABA9557E8670FBEADAB9CE3FB98488D3A6195B20007001F1647C0304DBBC7FD775544E7FA99E4B8382047C5BA36861E0985C736E0BC5D2C53CC86FB78F8965810C67933DA7305EF6FED98FD1E4817293D36CB9BF1060D723"),
            ByteUtils.HexToByteArray("A646995A1EAB5BB147BF11B535D238BF0B800AB30A63A7823FF593148823EA87C4BB42665F78A7D10720CF39044E0E1E15F96CF2F9F7277171"),
            ByteUtils.HexToByteArray("7B47BD53ED0A32D12AD2FC25A076C22E42B3E5038C87A3232DD74FD53FF41D1B14CA926F0FF158C9B8D1F5C512F8B32329B587650A48623E1FDA1D57B26FB5FF"),
        };

        public HmacGost3411_2012_512Tests()
            :base(s_testKeys,s_testData)
        {
        }

        protected override HMAC Create()
        {
            return new HMACGost3411_2012_512();
        }

        protected override HashAlgorithm CreateHashAlgorithm()
        {
            return Gost3411_2012_512.Create();
        }

        protected override int BlockSize{ get { return 64; } } 

        [Fact]
        public void HmacGost3411_2012_512_Byte_Constructors()
        {
            byte[] key = (byte[])s_testKeys[1].Clone();
            string digest = "8266DA1309FF8F69720867C9636B9B627159EB0BECD7C8D24E5B44234D2C719637171B9D7D1886573A2425FD5F71F5C74DF5D178E4921136944DFC4F114A15AF";

            using(HMACGost3411_2012_512 h1 = new HMACGost3411_2012_512(key))
            {
                VerifyHmac_KeyAlreadySet(h1, 1, digest);
                using(HMACGost3411_2012_512 h2 = new HMACGost3411_2012_512(key))
                {
                    VerifyHmac_KeyAlreadySet(h2, 1, digest);
                    Assert.Equal(h1.Key, h2.Key);
                }
            }
        }

        [Fact]
        public void HmacGost3411_2012_512_1()
        {
            VerifyHmac(1, "8266DA1309FF8F69720867C9636B9B627159EB0BECD7C8D24E5B44234D2C719637171B9D7D1886573A2425FD5F71F5C74DF5D178E4921136944DFC4F114A15AF");
        }

        [Fact]
        public void HmacGost3411_2012_512_2()
        {
            VerifyHmac(2, "AC7311C9FE5A4E04A4919A026BDD7B44CD637759186B30B90FB21E70B700643215F38EDDD77E32F0533A253C645CED16CAEDFF511C2AD201CFE222AA7CE2DB01");
        }

        [Fact]
        public void HmacGost3411_2012_512_3()
        {
            VerifyHmac(3, "CB5A8D323EDFF01C9DDEBDA3D8AD767CADFE8A6F623ECECDB57054D9D8300CFFDC72DC1B13822201F6B78399AD9CE513724FDF26BA51BB37DA5144E08438B35F");
        }

        [Fact]
        public void HmacGost3411_2012_512_4()
        {
            VerifyHmac(4, "419DDB4577FB6BEDDD09908E9B3C399418B97B1230DD499915BF8013749A1B580B66C7CA709D129F28D7B56228AF7C45341E2B97002E7A468BF6EAEEDE39514A");
        }

        [Fact]
        public void HmacGost3411_2012_512_5()
        {
            VerifyHmac(5, "76ABC6877D1F4211D607AD282B76CD86AFAFDE8A00C0AD95B9B1AD82A82281F48E9C5463FE913FFD75DBEF1EC4561ADA46517F17E67C3486B49AFDC7B50FC176");
        }

        [Fact]
        public void HmacGost3411_2012_512_6()
        {
            VerifyHmac(6, "0B92175310B2E49A3CA5CCA7B7D3CAAF4E11C321E4A2941A5ECFBFD65DFF2DD647C85D606957AA91641927E419845164AFB4C2CA048837405F3EEDFC560AB7B8");
        }

        [Fact]
        public void HmacGost3411_2012_512_7()
        {
            VerifyHmac(7, "B64822AF4B9649E3D7BB35AAEF2E76DA3C6E2915B38A8E8A4979C276A6DC4C6A843262977DA9D1E52F98637D6CE81F25A1E0292D2DEB4CF139E13A30F77E5D22");
        }

        [Fact]
        public void HmacGost3411_2012_512_Rfc2104_2()
        {
            VerifyHmacRfc2104_2();
        }
    }
}
